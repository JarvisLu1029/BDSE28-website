<!DOCTYPE HTML>

<html>

<head>
	<title>BDSE28 NO.4 車禍數據模型</title>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
	<link rel="stylesheet" href="../static/assets/css/main.css" />
	<link rel="icon" href="{{ url_for('static', filename='images/car_crash.png') }}">
	<noscript>
		<link rel="stylesheet" href="../static/assets/css/noscript.css" />
	</noscript>

	<!-- 載入jQuery -->
	<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>


	<!-- 縣市 js -->
	<script src="https://demeter.5fpro.com/tw/zipcode-selector.js"></script>

	<!-- leaflet -->
	<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.2/dist/leaflet.css"
		integrity="sha256-sA+zWATbFveLLNqWO2gtiw3HL/lh1giY/Inf1BJ0z14=" crossorigin="" />
	<script src="https://unpkg.com/leaflet@1.9.2/dist/leaflet.js"
		integrity="sha256-o9N1jGDZrf5tS+Ft4gbIK7mYMipq9lqpVJ91xHSyKhg=" crossorigin=""></script>

</head>

<body class="is-preload">

	<!-- Wrapper -->
	<div id="wrapper">

		<!-- Header -->
		<header id="header">
			<a href="/" class="logo">Group 4</a>
		</header>

		<!-- Nav -->
		<nav id="nav">
			<ul class="links">
				<li><a href="/">This is BDSE28 Group4</a></li>
				<li><a href="location">各縣市車禍分佈</a></li>
				<li class="active"><a href="model">車禍數據模型</a></li>

			</ul>
			<ul class="icons">
				<li><a href="#" class="icon brands fa-twitter"><span class="label">Twitter</span></a></li>
				<li><a href="#" class="icon brands fa-facebook-f"><span class="label">Facebook</span></a></li>
				<li><a href="#" class="icon brands fa-instagram"><span class="label">Instagram</span></a></li>
				<li><a href="#" class="icon brands fa-github"><span class="label">GitHub</span></a></li>
			</ul>
		</nav>

		<!-- Main -->
		<div id="main">

			<!-- Post -->
			<section class="post">
				<header class="major">
					<span class="date">April 25, 2017</span>
					<h1>This is a<br />
						Generic Page</h1>
					<p>Aenean ornare velit lacus varius enim ullamcorper proin aliquam<br />
						facilisis ante sed etiam magna interdum congue. Lorem ipsum dolor<br />
						amet nullam sed etiam veroeros.</p>
				</header>


				<input class="js-demeter-tw-zipcode-selector" data-city="#city" data-dist="#dist"
					placeholder="請輸入郵遞區號" />
				<select id="city" placeholder="請選擇縣市"></select>
				<select id="dist" placeholder="請選擇鄉鎮區"></select>
				<input id="road" type="text" placeholder="請輸入道路"></input>
				</br>
				<style>
					button {
						float: right;
					}
				</style>
				<button id="btn_request">送出查詢</button>

				<hr />

				<!-- leaflet地圖 -->
				<div id="map" class="box" style="height: 600px; width: 100%;"></div>


				<div id="result"></div>


				<script>

					const selectCity = document.querySelector('#city');
					const selectDist = document.querySelector('#dist');
					const inputRoad = document.querySelector('#road');


					let map = L.map('map').setView([25.0339145, 121.5412233], 13);

					//初始化地圖圖層(預設)
					L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
						attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
					}).addTo(map);

					let layerGroup = null;


					document.querySelector('button#btn_request').addEventListener('click', function (event) {
						const result = document.querySelector('#result');


						fetch(`/model/${selectCity.value}${selectDist.value}${inputRoad.value}`, {
							method: "GET"
						}).then(function (response) {
							return response.json();
						}).then(function (coordinate) {
							if (layerGroup != null && map.hasLayer(layerGroup)) {
								layerGroup.clearLayers();
								map.removeLayer(layerGroup);

								layerGroup = null;
							}
							result.textContent = coordinate;
							// 25.040569992289207,121.56273001877719

							map.panTo([coordinate[0], coordinate[1]], 13);

							L.marker([coordinate[0], coordinate[1]]).addTo(map)
								.bindPopup(`${coordinate[0]}, ${coordinate[1]}`)
								.openPopup();

						})


					})
				</script>




				<div class="image main"><img src="../static/images/pic01.jpg" alt="" /></div>
				<p>Donec eget ex magna. Interdum et malesuada fames ac ante ipsum primis in faucibus. Pellentesque
					venenatis dolor imperdiet dolor mattis sagittis. Praesent rutrum sem diam, vitae egestas enim auctor
					sit amet. Pellentesque leo mauris, consectetur id ipsum sit amet, fergiat. Pellentesque in mi eu
					massa lacinia malesuada et a elit. Donec urna ex, lacinia in purus ac, pretium pulvinar mauris. Nunc
					lorem mauris, fringilla in aliquam at, euismod in lectus. Pellentesque habitant morbi tristique
					senectus et netus et malesuada fames ac turpis egestas. Curabitur sapien risus, commodo eget turpis
					at, elementum convallis enim turpis, lorem ipsum dolor sit amet nullam.</p>
				<p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Duis dapibus rutrum facilisis. Class aptent
					taciti sociosqu ad litora torquent per conubia nostra, per inceptos himenaeos. Etiam tristique
					libero eu nibh porttitor fermentum. Nullam venenatis erat id vehicula viverra. Nunc ultrices eros ut
					ultricies condimentum. Mauris risus lacus, blandit sit amet venenatis non, bibendum vitae dolor.
					Nunc lorem mauris, fringilla in aliquam at, euismod in lectus. Pellentesque habitant morbi tristique
					senectus et netus et malesuada fames ac turpis egestas. In non lorem sit amet elit placerat maximus.
					Pellentesque aliquam maximus risus. Donec eget ex magna. Interdum et malesuada fames ac ante ipsum
					primis in faucibus. Pellentesque venenatis dolor imperdiet dolor mattis sagittis. Praesent rutrum
					sem diam, vitae egestas enim auctor sit amet. Pellentesque leo mauris, consectetur id ipsum.</p>
			</section>

		</div>

		<!-- Footer -->
		<footer id="footer">
			<section>
				<form method="post" action="#">
					<div class="fields">
						<div class="field">
							<label for="name">Name</label>
							<input type="text" name="name" id="name" />
						</div>
						<div class="field">
							<label for="email">Email</label>
							<input type="text" name="email" id="email" />
						</div>
						<div class="field">
							<label for="message">Message</label>
							<textarea name="message" id="message" rows="3"></textarea>
						</div>
					</div>
					<ul class="actions">
						<li><input type="submit" value="Send Message" /></li>
					</ul>
				</form>
			</section>
			<section class="split contact">
				<section class="alt">
					<h3>Address</h3>
					<p>1234 Somewhere Road #87257<br />
						Nashville, TN 00000-0000</p>
				</section>
				<section>
					<h3>Phone</h3>
					<p><a href="#">(000) 000-0000</a></p>
				</section>
				<section>
					<h3>Email</h3>
					<p><a href="#">info@untitled.tld</a></p>
				</section>
				<section>
					<h3>Social</h3>
					<ul class="icons alt">
						<li><a href="#" class="icon brands alt fa-twitter"><span class="label">Twitter</span></a></li>
						<li><a href="#" class="icon brands alt fa-facebook-f"><span class="label">Facebook</span></a>
						</li>
						<li><a href="#" class="icon brands alt fa-instagram"><span class="label">Instagram</span></a>
						</li>
						<li><a href="#" class="icon brands alt fa-github"><span class="label">GitHub</span></a></li>
					</ul>
				</section>
			</section>
		</footer>

		<!-- Copyright -->
		<div id="copyright">
			<ul>
				<li>&copy; Untitled</li>
				<li>Design: <a href="https://html5up.net">HTML5 UP</a></li>
			</ul>
		</div>

	</div>

	<!-- Scripts -->
	<script src="../static/assets/js/jquery.min.js"></script>
	<script src="../static/assets/js/jquery.scrollex.min.js"></script>
	<script src="../static/assets/js/jquery.scrolly.min.js"></script>
	<script src="../static/assets/js/browser.min.js"></script>
	<script src="../static/assets/js/breakpoints.min.js"></script>
	<script src="../static/assets/js/util.js"></script>
	<script src="../static/assets/js/main.js"></script>

</body>

</html>